import{defineComponent as e,ref as t,computed as a,watch as n,resolveComponent as o,openBlock as i,createElementBlock as r,createElementVNode as l,createVNode as d,createBlock as u,withCtx as s,createCommentVNode as v,createTextVNode as c,toDisplayString as m}from"vue";const p={class:"oembed-field"},f={class:"url-input-section"},h={key:0,class:"loading-section"},b={key:1,class:"error-section"},w={key:2,class:"preview-section"},g={class:"preview-header"},y={class:"preview-content"},x={key:0,class:"embed-container"},_=["src","width","height"],k={key:1,class:"photo-container"},T=["src","alt"],V={key:2,class:"link-container"},E={key:0},Y=["href"],S={class:"metadata-section"},U={class:"metadata-grid"},R={key:0,class:"metadata-item"},L={key:1,class:"metadata-item"},j={key:2,class:"metadata-item"},P={key:3,class:"metadata-item"},A={key:3,class:"raw-data-section"};var I=e({__name:"interface",props:{value:{},disabled:{type:Boolean},placeholder:{default:"Paste a video URL (YouTube, Vimeo, etc.)"},auto_fetch:{type:Boolean,default:!0},show_preview:{type:Boolean,default:!0}},emits:["input"],setup(e,{emit:I}){const O=e,$=I,z=t(""),B=t(!1),C=t(""),D=t(null),q=t(null);O.value&&(q.value=O.value,O.value.url&&(z.value=O.value.url),O.value.oembed&&(D.value=O.value.oembed));const N=a((()=>O.placeholder)),F=a((()=>O.show_preview)),G=[{provider:"YouTube",endpoint:"https://www.youtube.com/oembed",schemes:["*://www.youtube.com/watch*","*://youtu.be/*"]},{provider:"Vimeo",endpoint:"https://vimeo.com/api/oembed.json",schemes:["*://vimeo.com/*"]},{provider:"Twitter",endpoint:"https://publish.twitter.com/oembed",schemes:["*://twitter.com/*/status/*","*://x.com/*/status/*"]},{provider:"Instagram",endpoint:"https://api.instagram.com/oembed",schemes:["*://www.instagram.com/p/*","*://instagram.com/p/*"]},{provider:"TikTok",endpoint:"https://www.tiktok.com/oembed",schemes:["*://www.tiktok.com/*"]},{provider:"Spotify",endpoint:"https://open.spotify.com/oembed",schemes:["*://open.spotify.com/*"]}];function H(e){const t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);return t?t[1]:null}function J(e){const t=e.match(/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|)(\d+)(?:$|\/|\?)/);return t?t[3]:null}function K(){if(!D.value)return"";if("YouTube"===D.value.provider_name){const e=H(z.value);return e?`https://www.youtube.com/embed/${e}`:""}if("Vimeo"===D.value.provider_name){const e=J(z.value);return e?`https://player.vimeo.com/video/${e}`:""}return""}async function M(){if(z.value&&O.auto_fetch){B.value=!0,C.value="";try{const e=function(e){for(const t of G)for(const a of t.schemes)if(new RegExp(a.replace(/\*/g,".*")).test(e))return t;return null}(z.value);if(!e)throw new Error("Unsupported video platform. Supported: YouTube, Vimeo");let t;if("YouTube"===e.provider){const e=H(z.value);if(!e)throw new Error("Invalid YouTube URL");t={type:"video",version:"1.0",title:"YouTube Video",author_name:"YouTube",provider_name:"YouTube",provider_url:"https://www.youtube.com",thumbnail_url:`https://img.youtube.com/vi/${e}/hqdefault.jpg`,html:`<iframe width="560" height="315" src="https://www.youtube.com/embed/${e}" frameborder="0" allowfullscreen></iframe>`,width:560,height:315}}else if("Vimeo"===e.provider){const e=J(z.value);if(!e)throw new Error("Invalid Vimeo URL");t={type:"video",version:"1.0",title:"Vimeo Video",author_name:"Vimeo",provider_name:"Vimeo",provider_url:"https://vimeo.com",html:`<iframe src="https://player.vimeo.com/video/${e}" width="640" height="360" frameborder="0" allowfullscreen></iframe>`,width:640,height:360}}else t={type:"link",version:"1.0",title:z.value,provider_name:e.provider,provider_url:z.value};D.value=t,q.value={url:z.value,oembed:t,fetched_at:(new Date).toISOString()},$("input",q.value)}catch(e){C.value=e instanceof Error?e.message:"Failed to process URL",D.value=null,q.value={url:z.value,error:C.value,fetched_at:(new Date).toISOString()},$("input",q.value)}finally{B.value=!1}}}function Q(e){z.value=e,e?O.auto_fetch&&function(e){try{return new URL(e),!0}catch(e){return!1}}(e)&&setTimeout((()=>{z.value===e&&M()}),500):W()}function W(){z.value="",D.value=null,q.value=null,C.value="",$("input",null)}return n((()=>O.value),(e=>{e!==q.value&&(q.value=e,(null==e?void 0:e.url)&&(z.value=e.url),(null==e?void 0:e.oembed)&&(D.value=e.oembed))})),(e,t)=>{const a=o("v-input"),n=o("v-icon"),I=o("v-button"),O=o("v-progress-circular"),$=o("v-notice");return i(),r("div",p,[l("div",f,[d(a,{"model-value":z.value,placeholder:N.value,"onUpdate:modelValue":Q,onBlur:M,disabled:e.disabled},null,8,["model-value","placeholder","disabled"]),z.value&&!B.value?(i(),u(I,{key:0,onClick:M,icon:"",secondary:"",small:"",disabled:e.disabled},{default:s((()=>[d(n,{name:"refresh"})])),_:1},8,["disabled"])):v("v-if",!0)]),B.value?(i(),r("div",h,[d(O,{indeterminate:"",small:""}),t[0]||(t[0]=l("span",{class:"loading-text"},"Processing video URL...",-1))])):v("v-if",!0),C.value?(i(),r("div",b,[d($,{type:"warning",icon:!1},{default:s((()=>[c(m(C.value),1)])),_:1})])):v("v-if",!0),D.value&&F.value&&!B.value?(i(),r("div",w,[l("div",g,[t[1]||(t[1]=l("h4",null,"Preview",-1)),d(I,{onClick:W,icon:"",secondary:"",small:""},{default:s((()=>[d(n,{name:"close"})])),_:1})]),l("div",y,["video"===D.value.type?(i(),r("div",x,[l("iframe",{src:K(),width:D.value.width||560,height:D.value.height||315,frameborder:"0",allowfullscreen:""},null,8,_)])):"photo"===D.value.type?(i(),r("div",k,[l("img",{src:D.value.url,alt:D.value.title},null,8,T)])):(i(),r("div",V,[l("h5",null,m(D.value.title),1),D.value.description?(i(),r("p",E,m(D.value.description),1)):v("v-if",!0),l("a",{href:z.value,target:"_blank",rel:"noopener noreferrer"},m(z.value),9,Y)]))]),l("div",S,[l("div",U,[D.value.title?(i(),r("div",R,[t[2]||(t[2]=l("strong",null,"Title:",-1)),c(" "+m(D.value.title),1)])):v("v-if",!0),D.value.provider_name?(i(),r("div",L,[t[3]||(t[3]=l("strong",null,"Provider:",-1)),c(" "+m(D.value.provider_name),1)])):v("v-if",!0),D.value.author_name?(i(),r("div",j,[t[4]||(t[4]=l("strong",null,"Author:",-1)),c(" "+m(D.value.author_name),1)])):v("v-if",!0),D.value.width&&D.value.height?(i(),r("div",P,[t[5]||(t[5]=l("strong",null,"Dimensions:",-1)),c(" "+m(D.value.width)+"Ã—"+m(D.value.height),1)])):v("v-if",!0)])])])):v("v-if",!0),q.value&&!F.value?(i(),r("div",A,[d($,{type:"info"},{default:s((()=>[c(" oEmbed data stored ("+m(Object.keys(q.value).length)+" fields) ",1)])),_:1})])):v("v-if",!0)])}}}),O=[],$=[];!function(e,t){if(e&&"undefined"!=typeof document){var a,n=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var r=O.indexOf(i);-1===r&&(r=O.push(i)-1,$[r]={}),a=$[r]&&$[r][n]?$[r][n]:$[r][n]=l()}else a=l();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function l(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var a=Object.keys(t.attributes),o=0;o<a.length;o++)e.setAttribute(a[o],t.attributes[a[o]]);var r="prepend"===n?"afterbegin":"beforeend";return i.insertAdjacentElement(r,e),e}}("\n.oembed-field[data-v-5d83f470] {\n\t\twidth: 100%;\n}\n.url-input-section[data-v-5d83f470] {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t\tmargin-bottom: 16px;\n}\n.url-input-section .v-input[data-v-5d83f470] {\n\t\tflex: 1;\n}\n.loading-section[data-v-5d83f470] {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tmargin-bottom: 16px;\n\t\tcolor: var(--foreground-subdued);\n}\n.loading-text[data-v-5d83f470] {\n\t\tfont-size: 14px;\n}\n.error-section[data-v-5d83f470] {\n\t\tmargin-bottom: 16px;\n}\n.preview-section[data-v-5d83f470] {\n\t\tborder: 1px solid var(--border-subdued);\n\t\tborder-radius: 6px;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 16px;\n}\n.preview-header[data-v-5d83f470] {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 12px 16px;\n\t\tbackground-color: var(--background-subdued);\n\t\tborder-bottom: 1px solid var(--border-subdued);\n}\n.preview-header h4[data-v-5d83f470] {\n\t\tmargin: 0;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--foreground);\n}\n.preview-content[data-v-5d83f470] {\n\t\tpadding: 16px;\n}\n.embed-container[data-v-5d83f470] {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\tmax-width: 100%;\n}\n.embed-container iframe[data-v-5d83f470] {\n\t\tmax-width: 100%;\n\t\theight: auto;\n}\n.photo-container img[data-v-5d83f470] {\n\t\tmax-width: 100%;\n\t\theight: auto;\n\t\tborder-radius: 4px;\n}\n.link-container h5[data-v-5d83f470] {\n\t\tmargin: 0 0 8px 0;\n\t\tcolor: var(--foreground);\n}\n.link-container p[data-v-5d83f470] {\n\t\tmargin: 0 0 12px 0;\n\t\tcolor: var(--foreground-subdued);\n\t\tfont-size: 14px;\n}\n.link-container a[data-v-5d83f470] {\n\t\tcolor: var(--primary);\n\t\ttext-decoration: none;\n\t\tfont-size: 14px;\n}\n.link-container a[data-v-5d83f470]:hover {\n\t\ttext-decoration: underline;\n}\n.metadata-section[data-v-5d83f470] {\n\t\tpadding: 12px 16px;\n\t\tbackground-color: var(--background-subdued);\n\t\tborder-top: 1px solid var(--border-subdued);\n}\n.metadata-grid[data-v-5d83f470] {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n\t\tgap: 8px;\n}\n.metadata-item[data-v-5d83f470] {\n\t\tfont-size: 12px;\n\t\tcolor: var(--foreground-subdued);\n}\n.metadata-item strong[data-v-5d83f470] {\n\t\tcolor: var(--foreground);\n}\n.raw-data-section[data-v-5d83f470] {\n\t\tmargin-bottom: 16px;\n}\n",{});var z={id:"video-embed-field",name:"Video Embed",icon:"video_library",description:"Embed videos from YouTube, Vimeo, and other video platforms",component:((e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a})(I,[["__scopeId","data-v-5d83f470"],["__file","interface.vue"]]),options:[{field:"placeholder",name:"Placeholder Text",type:"string",meta:{width:"full",interface:"input"},schema:{default_value:"Paste a video URL (YouTube, Vimeo, etc.)"}},{field:"auto_fetch",name:"Auto-process URLs",type:"boolean",meta:{width:"half",interface:"boolean"},schema:{default_value:!0}},{field:"show_preview",name:"Show Preview",type:"boolean",meta:{width:"half",interface:"boolean"},schema:{default_value:!0}}],types:["json"]};export{z as default};
