import{defineComponent as e,ref as t,computed as a,watch as n,resolveComponent as o,openBlock as i,createElementBlock as r,createElementVNode as l,createVNode as u,createBlock as d,withCtx as s,createCommentVNode as v,createTextVNode as c,toDisplayString as m}from"vue";const p={class:"oembed-field"},f={class:"url-input-section"},h={key:0,class:"loading-section"},b={key:1,class:"error-section"},g={key:2,class:"preview-section"},w={class:"preview-header"},y={class:"preview-content"},_={class:"embed-container"},x=["src","width","height"],T={class:"metadata-section"},k={class:"metadata-grid"},V={key:0,class:"metadata-item"},E={key:1,class:"metadata-item"},Y={key:2,class:"metadata-item"},U={key:3,class:"raw-data-section"};var R=e({__name:"interface",props:{value:{},disabled:{type:Boolean},placeholder:{default:"Paste a video URL (YouTube, Vimeo, etc.)"},auto_fetch:{type:Boolean,default:!0},show_preview:{type:Boolean,default:!0}},emits:["input"],setup(e,{emit:R}){const S=e,L=R,P=t(""),j=t(!1),A=t(""),O=t(null),$=t(null);S.value&&($.value=S.value,S.value.url&&(P.value=S.value.url),S.value.oembed&&(O.value=S.value.oembed));const B=a((()=>S.placeholder)),I=a((()=>S.show_preview)),C=[{provider:"YouTube",schemes:["*://www.youtube.com/watch*","*://youtu.be/*"]},{provider:"Vimeo",schemes:["*://vimeo.com/*"]}];function z(e){const t=e.match(/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/);return t?t[1]:null}function q(e){const t=e.match(/vimeo\.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|)(\d+)(?:$|\/|\?)/);return t?t[3]:null}function D(){if(!O.value)return"";if("YouTube"===O.value.provider_name){const e=z(P.value);return e?`https://www.youtube.com/embed/${e}`:""}if("Vimeo"===O.value.provider_name){const e=q(P.value);return e?`https://player.vimeo.com/video/${e}`:""}return""}async function N(){if(P.value&&S.auto_fetch){j.value=!0,A.value="";try{const e=function(e){for(const t of C)for(const a of t.schemes)if(new RegExp(a.replace(/\*/g,".*")).test(e))return t;return null}(P.value);if(!e)throw new Error("Unsupported video platform. Supported: YouTube, Vimeo");let t;if("YouTube"===e.provider){const e=z(P.value);if(!e)throw new Error("Invalid YouTube URL");t={type:"video",version:"1.0",title:"YouTube Video",author_name:"YouTube",provider_name:"YouTube",provider_url:"https://www.youtube.com",video_id:e,thumbnail_url:`https://img.youtube.com/vi/${e}/hqdefault.jpg`,html:`<iframe width="640" height="360" src="https://www.youtube.com/embed/${e}" frameborder="0" allowfullscreen></iframe>`,width:640,height:360}}else if("Vimeo"===e.provider){const e=q(P.value);if(!e)throw new Error("Invalid Vimeo URL");t={type:"video",version:"1.0",title:"Vimeo Video",author_name:"Vimeo",provider_name:"Vimeo",provider_url:"https://vimeo.com",video_id:e,html:`<iframe src="https://player.vimeo.com/video/${e}" width="640" height="360" frameborder="0" allowfullscreen></iframe>`,width:640,height:360}}O.value=t,$.value={url:P.value,oembed:t,fetched_at:(new Date).toISOString()},L("input",$.value)}catch(e){A.value=e instanceof Error?e.message:"Failed to process URL",O.value=null,$.value={url:P.value,error:A.value,fetched_at:(new Date).toISOString()},L("input",$.value)}finally{j.value=!1}}}function F(e){P.value=e,e?S.auto_fetch&&function(e){try{return new URL(e),!0}catch(e){return!1}}(e)&&setTimeout((()=>{P.value===e&&N()}),500):G()}function G(){P.value="",O.value=null,$.value=null,A.value="",L("input",null)}return n((()=>S.value),(e=>{e!==$.value&&($.value=e,(null==e?void 0:e.url)&&(P.value=e.url),(null==e?void 0:e.oembed)&&(O.value=e.oembed))})),(e,t)=>{const a=o("v-input"),n=o("v-icon"),R=o("v-button"),S=o("v-progress-circular"),L=o("v-notice");return i(),r("div",p,[l("div",f,[u(a,{"model-value":P.value,placeholder:B.value,"onUpdate:modelValue":F,onBlur:N,disabled:e.disabled},null,8,["model-value","placeholder","disabled"]),P.value&&!j.value?(i(),d(R,{key:0,onClick:N,icon:"",secondary:"",small:"",disabled:e.disabled},{default:s((()=>[u(n,{name:"refresh"})])),_:1},8,["disabled"])):v("v-if",!0)]),j.value?(i(),r("div",h,[u(S,{indeterminate:"",small:""}),t[0]||(t[0]=l("span",{class:"loading-text"},"Processing video URL...",-1))])):v("v-if",!0),A.value?(i(),r("div",b,[u(L,{type:"warning",icon:!1},{default:s((()=>[c(m(A.value),1)])),_:1})])):v("v-if",!0),O.value&&I.value&&!j.value?(i(),r("div",g,[l("div",w,[t[1]||(t[1]=l("h4",null,"Preview",-1)),u(R,{onClick:G,icon:"",secondary:"",small:""},{default:s((()=>[u(n,{name:"close"})])),_:1})]),l("div",y,[l("div",_,[l("iframe",{src:D(),width:O.value.width||640,height:O.value.height||360,frameborder:"0",allowfullscreen:""},null,8,x)])]),l("div",T,[l("div",k,[O.value.title?(i(),r("div",V,[t[2]||(t[2]=l("strong",null,"Title:",-1)),c(" "+m(O.value.title),1)])):v("v-if",!0),O.value.provider_name?(i(),r("div",E,[t[3]||(t[3]=l("strong",null,"Provider:",-1)),c(" "+m(O.value.provider_name),1)])):v("v-if",!0),O.value.author_name?(i(),r("div",Y,[t[4]||(t[4]=l("strong",null,"Author:",-1)),c(" "+m(O.value.author_name),1)])):v("v-if",!0)])])])):v("v-if",!0),$.value&&!I.value?(i(),r("div",U,[u(L,{type:"info"},{default:s((()=>[c(" oEmbed data stored ("+m(Object.keys($.value).length)+" fields) ",1)])),_:1})])):v("v-if",!0)])}}}),S=[],L=[];!function(e,t){if(e&&"undefined"!=typeof document){var a,n=!0===t.prepend?"prepend":"append",o=!0===t.singleTag,i="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(o){var r=S.indexOf(i);-1===r&&(r=S.push(i)-1,L[r]={}),a=L[r]&&L[r][n]?L[r][n]:L[r][n]=l()}else a=l();65279===e.charCodeAt(0)&&(e=e.substring(1)),a.styleSheet?a.styleSheet.cssText+=e:a.appendChild(document.createTextNode(e))}function l(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var a=Object.keys(t.attributes),o=0;o<a.length;o++)e.setAttribute(a[o],t.attributes[a[o]]);var r="prepend"===n?"afterbegin":"beforeend";return i.insertAdjacentElement(r,e),e}}("\n.oembed-field[data-v-9665a7f7] {\n\t\twidth: 100%;\n}\n.url-input-section[data-v-9665a7f7] {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\talign-items: center;\n\t\tmargin-bottom: 16px;\n}\n.url-input-section .v-input[data-v-9665a7f7] {\n\t\tflex: 1;\n}\n.loading-section[data-v-9665a7f7] {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 8px;\n\t\tmargin-bottom: 16px;\n\t\tcolor: var(--foreground-subdued);\n}\n.loading-text[data-v-9665a7f7] {\n\t\tfont-size: 14px;\n}\n.error-section[data-v-9665a7f7] {\n\t\tmargin-bottom: 16px;\n}\n.preview-section[data-v-9665a7f7] {\n\t\tborder: 1px solid var(--border-subdued);\n\t\tborder-radius: 6px;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 16px;\n}\n.preview-header[data-v-9665a7f7] {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tpadding: 12px 16px;\n\t\tbackground-color: var(--background-subdued);\n\t\tborder-bottom: 1px solid var(--border-subdued);\n}\n.preview-header h4[data-v-9665a7f7] {\n\t\tmargin: 0;\n\t\tfont-size: 14px;\n\t\tfont-weight: 600;\n\t\tcolor: var(--foreground);\n}\n.preview-content[data-v-9665a7f7] {\n\t\tpadding: 16px;\n}\n.embed-container[data-v-9665a7f7] {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t\tmax-width: 100%;\n}\n.embed-container iframe[data-v-9665a7f7] {\n\t\tmax-width: 100%;\n\t\theight: auto;\n\t\taspect-ratio: 16 / 9;\n}\n.metadata-section[data-v-9665a7f7] {\n\t\tpadding: 12px 16px;\n\t\tbackground-color: var(--background-subdued);\n\t\tborder-top: 1px solid var(--border-subdued);\n}\n.metadata-grid[data-v-9665a7f7] {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n\t\tgap: 8px;\n}\n.metadata-item[data-v-9665a7f7] {\n\t\tfont-size: 12px;\n\t\tcolor: var(--foreground-subdued);\n}\n.metadata-item strong[data-v-9665a7f7] {\n\t\tcolor: var(--foreground);\n}\n.raw-data-section[data-v-9665a7f7] {\n\t\tmargin-bottom: 16px;\n}\n",{});var P={id:"video-embed-field",name:"Video Embed",icon:"video_library",description:"Embed videos from YouTube, Vimeo, and other video platforms",component:((e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a})(R,[["__scopeId","data-v-9665a7f7"],["__file","interface.vue"]]),options:[{field:"placeholder",name:"Placeholder Text",type:"string",meta:{width:"full",interface:"input"},schema:{default_value:"Paste a video URL (YouTube, Vimeo, etc.)"}},{field:"auto_fetch",name:"Auto-process URLs",type:"boolean",meta:{width:"half",interface:"boolean"},schema:{default_value:!0}},{field:"show_preview",name:"Show Preview",type:"boolean",meta:{width:"half",interface:"boolean"},schema:{default_value:!0}}],types:["json"]};export{P as default};
